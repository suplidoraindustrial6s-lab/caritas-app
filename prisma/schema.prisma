generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

// Grupos de atención (Ej. Fe, Esperanza, Caridad, Amor, Lista de Espera)
model Group {
  id          Int           @id @default(autoincrement())
  name        String        @unique // Nombre corto creativo
  description String?
  beneficiaries Beneficiary[]
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
}

// Beneficiarios
model Beneficiary {
  id              Int           @id @default(autoincrement())
  fullName        String
  nationalId      String        @unique // Cédula de Identidad
  birthDate       DateTime
  placeOfBirth    String
  gender          String        // M/F
  address         String
  zone            String?       // Zona de residencia (Ej. El Limón, Caña de Azúcar)
  photoUrl        String?       // URL de la foto carnet
  chronicIllness  String?       // "None" or description
  hasChildren     Boolean       @default(false)
  
  // Relaciones
  groupId         Int?
  group           Group?        @relation(fields: [groupId], references: [id])
  children        Child[]
  attendances     Attendance[]
  
  observations    String?
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
}

// Hijos de beneficiarios
model Child {
  id              Int           @id @default(autoincrement())
  fullName        String
  gender          String        // M/F
  nationalId      String?
  birthDate       DateTime
  isStudying      Boolean       @default(false)
  observations    String?
  
  beneficiaryId   Int
  beneficiary     Beneficiary   @relation(fields: [beneficiaryId], references: [id], onDelete: Cascade)
}

// Registro de Asistencia y Atención
model Attendance {
  id                Int         @id @default(autoincrement())
  date              DateTime    // Fecha de atención
  
  beneficiaryId     Int
  beneficiary       Beneficiary @relation(fields: [beneficiaryId], references: [id])
  
  // Detalles de la ayuda recibida
  receivedFood      Boolean     @default(false)
  foodQuantity      Int         @default(0) // Cantidad de bolsas/alimentos
  receivedClothes   Boolean     @default(false)
  clothesQuantity   Int         @default(0) // Cantidad de prendas
  receivedMedical   Boolean     @default(false)
  medicinesReceived String?     // Lista de medicinas separadas por coma
  
  signature         String?     // Podría ser un path a una imagen o boolean si firmó en físico
  
  createdAt         DateTime    @default(now())
}
